"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3586],{45217:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var n=t(74848),i=t(28453);const a={layout:"default",title:"Heatmap Module",parent:"Analytics",grand_parent:"Libraries",nav_order:6},r="Heatmap Module",l={id:"libraries/analytics/heatmap",title:"Heatmap Module",description:"Features",source:"@site/docs/libraries/analytics/heatmap.md",sourceDirName:"libraries/analytics",slug:"/libraries/analytics/heatmap",permalink:"/dokku/docs/libraries/analytics/heatmap",draft:!1,unlisted:!1,editUrl:"https://github.com/sinequa/sba-angular/tree/main/docs/libraries/analytics/heatmap.md",tags:[],version:"current",frontMatter:{layout:"default",title:"Heatmap Module",parent:"Analytics",grand_parent:"Libraries",nav_order:6},sidebar:"tutorialSidebar",previous:{title:"Google Maps Module",permalink:"/dokku/docs/libraries/analytics/googlemaps"},next:{title:"Network Module",permalink:"/dokku/docs/libraries/analytics/network"}},c={},o=[{value:"Features",id:"features",level:2},{value:"Import",id:"import",level:2},{value:"Server-side setup",id:"server-side-setup",level:2},{value:"Heatmap Facet",id:"heatmap-facet",level:2},{value:"Heatmap results view",id:"heatmap-results-view",level:2},{value:"Heatmap component",id:"heatmap-component",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"heatmap-module",children:"Heatmap Module"}),"\n",(0,n.jsx)(s.h2,{id:"features",children:"Features"}),"\n",(0,n.jsxs)(s.p,{children:["This module includes a Heatmap visualization of 2-dimensional data based on the ",(0,n.jsx)(s.a,{href:"https://d3js.org/",children:"D3 library"}),". This chart is available:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"As a simple component taking data as an input and displaying it, unaware of Sinequa's API and data structures."}),"\n",(0,n.jsx)(s.li,{children:"As a facet component, managing the transformation of an aggregation into the heatmap data, and displaying actions to customize this aggregation, as well as a settings panel."}),"\n",(0,n.jsxs)(s.li,{children:["As a results view component (mostly for compatibility), directly based on the facet component, but displayed in a slightly different way since the component is not meant to live in a ",(0,n.jsx)(s.code,{children:"sq-facet-card"})," wrapper (See ",(0,n.jsx)(s.a,{href:"/dokku/docs/libraries/components/facet",children:"Facet module"}),")."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Heatmap",src:t(72828).A+"",width:"744",height:"786"})}),"\n",(0,n.jsx)(s.h2,{id:"import",children:"Import"}),"\n",(0,n.jsxs)(s.p,{children:["Import this module in your ",(0,n.jsx)(s.code,{children:"app.module.ts"}),"."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:"import { BsHeatmapModule } from '@sinequa/analytics/heatmap';\n\n@NgModule({\n  imports: [\n    ...\n    BsHeatmapModule\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This module is internationalized: If not already the case, you need to import its messages for the language(s) of your application. For example, in your app's ",(0,n.jsx)(s.code,{children:"src/locales/en.ts"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:'...\nimport {enHeatmap} from "@sinequa/analytics/heatmap";\n\nconst messages = Utils.merge({}, ..., enHeatmap, appMessages);\n'})}),"\n",(0,n.jsx)(s.h2,{id:"server-side-setup",children:"Server-side setup"}),"\n",(0,n.jsxs)(s.p,{children:["The heatmap can display two types of aggregations, configured on the server side (in the ",(0,n.jsx)(s.strong,{children:"query"})," web service):"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Cross-distributions"})," (or ",(0,n.jsx)(s.strong,{children:"cross-correlations"}),'): By default the "Heatmap" aggregation configured in the default query web service is a cross-distribution. The engine dynamically computes the number of documents mentioning 2 values of metadata together. For example, we can compute the cross-distribution of the ',(0,n.jsx)(s.strong,{children:"people"})," and ",(0,n.jsx)(s.strong,{children:"company"})," columns which yields the following list:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"Bill Gates/Microsoft;15"})," (Bill Gates and Microsoft are mentioned together in 15 records)"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"Elon Musk/Tesla;13"})," (Elon Musk and Tesla are mentioned together in 13 records)"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"etc."}),"\n",(0,n.jsx)(s.p,{children:"\u26a0\ufe0f Note that these computations may scale poorly with the number of records/documents in the case of multi-valued columns and long documents (if a document contains 100 entities of each type, that means already 10000 unique combinations for a single document)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Cooccurrences"}),": The Sinequa indexer can extract in a column the co-occurrences of two entities within a close neighborhood. In this case the aggregation is similar to any other 1-dimension distribution or correlation (used in list facets), except the data contains 2 values instead of one:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"(Bill Gates)#(Microsoft);15"})," (Bill Gates and Microsoft are closely mentioned together 15 times)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"(Elon Musk)#(Tesla);13"})," (...)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Note that in both cases, the computation can be computationally expensive (especially cross-distribution) and return a lot of data. Therefore, it is recommended to uncheck the ",(0,n.jsx)(s.em,{children:"Include in standard search"})," option of the aggregation (unless the heatmap is really meant to be displayed all the time) and set a reasonable ",(0,n.jsx)(s.em,{children:"count"})," option (which can result in some sparsity in the heatmap)."]}),"\n",(0,n.jsx)(s.p,{children:"The heatmap facet and results view take care of querying the server if the heatmap aggregation is not included in the standard search."}),"\n",(0,n.jsx)(s.h2,{id:"heatmap-facet",children:"Heatmap Facet"}),"\n",(0,n.jsxs)(s.p,{children:["The heatmap facet (",(0,n.jsx)(s.code,{children:"sq-facet-heatmap"}),") looks as the image above. It can be displayed with:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-html",children:"<sq-facet-card [icon]=\"'fas fa-th'\" [title]=\"'Awesome Heatmap'\">\n    <sq-facet-heatmap #facet [results]=\"results\" [fieldX]=\"'geo'\" [fieldY]=\"'company'\" [fieldsX]=\"['geo', 'company', 'person']\" [fieldsY]=\"['geo', 'company', 'person']\"></sq-facet-heatmap>\n</sq-facet-card>\n"})}),"\n",(0,n.jsx)(s.p,{children:"This facet includes a settings template which lets the user tune some of the heatmap parameters:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Settings",src:t(5577).A+"",width:"745",height:"516"})}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"sq-facet-heatmap"})," component accepts the following inputs:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"results"}),": The current results"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"aggregation"})," (default: ",(0,n.jsx)(s.code,{children:"'Heatmap'"}),", the name of the default aggregation configured in the query web service): Name of the aggregation which contains the data."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"name"}),": An optional name to identify the facet in the user preferences and breadcrumbs."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"fieldX"})," (in cross-distribution mode): Default column to display on the X axis (parameter overriden in User Preferences)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"fieldY"})," (in cross-distribution mode): Default column to display on the Y axis (parameter overriden in User Preferences)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"fieldsX"})," (in cross-distribution mode): List of all columns available for the X axis."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"fieldsY"})," (in cross-distribution mode): List of all columns available for the Y axis."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"fieldCooc"})," (in co-occurrence mode): Name of the co-occurrence column."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"width"})," (default: ",(0,n.jsx)(s.code,{children:"600"}),"): Default width of the chart (parameter overriden in User Preferences if user checks ",(0,n.jsx)(s.em,{children:"rescale axes"}),"). In any case the chart is resized to fit the container's width (the aspect ratio is respected)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"height"})," (default: ",(0,n.jsx)(s.code,{children:"600"}),"): Default height of the chart (parameter overriden in User Preferences if user checks ",(0,n.jsx)(s.em,{children:"rescale axes"}),")."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"margin"})," (default: ",(0,n.jsx)(s.code,{children:"{top: 100, bottom: 20, left: 100, right: 40}"}),"): Margins used to draw the chart while leaving space for the legend and axes."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"transition"})," (default: ",(0,n.jsx)(s.code,{children:"1000"}),"): Number of milliseconds in a transition (which animate the axes)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"buckets"})," (default: ",(0,n.jsx)(s.code,{children:"9"}),"): Number of quantiles used to split the data (= number of colors)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"colorScheme"})," (default: ",(0,n.jsx)(s.code,{children:"'schemeBlues"}),"): Color scheme used to display the heatmap color gradient. All the schemes available are available ",(0,n.jsx)(s.a,{href:"https://github.com/d3/d3-scale-chromatic",children:"here"})," (parameter overriden in User Preferences)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"maxX"})," (default: ",(0,n.jsx)(s.code,{children:"20"}),"): Maximum number of items on the X axis (parameter overriden in User Preferences)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"maxY"})," (default: ",(0,n.jsx)(s.code,{children:"20"}),"): Maximum number of items on the Y axis (parameter overriden in User Preferences)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"itemsClickable"})," (default: ",(0,n.jsx)(s.code,{children:"true"}),"): Whether the heatmap's tiles are clickable or not (resulting in filtering the search)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"axisClickable"})," (default: ",(0,n.jsx)(s.code,{children:"true"}),"): Whether the items on the heatmap axis are clickable (resulting in filtering the search)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"highlightSelected"})," (default: ",(0,n.jsx)(s.code,{children:"true"}),'): Whether the heatmap tiles should be marked as "selected" when a record containing these tiles is selected (which alters the tile\'s opacity).']}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"heatmap-results-view",children:"Heatmap results view"}),"\n",(0,n.jsxs)(s.p,{children:["The heatmap results view (",(0,n.jsx)(s.code,{children:"sq-results-heatmap-view"}),") is based directly on the ",(0,n.jsx)(s.code,{children:"sq-facet-heatmap"})," component (by inheritance). The differences are the following:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["To use this component it is required to import the ",(0,n.jsx)(s.code,{children:"BsResultsViewModule"})," module in your ",(0,n.jsx)(s.code,{children:"app.module.ts"})," and inject a list of results views and a default one via the ",(0,n.jsx)(s.code,{children:"forRoot()"})," method."]}),"\n",(0,n.jsxs)(s.li,{children:["Since the view is not wrapped inside a ",(0,n.jsx)(s.code,{children:"sq-facet-card"})," component, the list of actions is displayed above the view, including a button to toggle the settings panel."]}),"\n",(0,n.jsxs)(s.li,{children:["The ",(0,n.jsx)(s.code,{children:"sq-results-heatmap-view"})," component accepts all the parameters of the ",(0,n.jsx)(s.code,{children:"sq-facet-heatmap"})," component, plus an additional optional one: ",(0,n.jsx)(s.code,{children:"selectView"})," which allows to change the current results view when an item is selected. For example, ",(0,n.jsx)(s.code,{children:"[selectView]=\"'List'\""}),' will switch to the "List" results view when a tile is clicked.']}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"heatmap-component",children:"Heatmap component"}),"\n",(0,n.jsx)("doc-heatmap",{}),"\n",(0,n.jsxs)(s.p,{children:["The heatmap component (",(0,n.jsx)(s.code,{children:"sq-heatmap"}),") only takes care of displaying the chart. It accepts as inputs most of the graphical settings defined above, but it does not take care of querying the server for data."]}),"\n",(0,n.jsxs)(s.p,{children:["When used in isolation, this component needs the ",(0,n.jsx)(s.code,{children:"data"})," input, which is a list of objects implementing the ",(0,n.jsx)(s.code,{children:"HeatmapItem"})," interface:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:'export interface HeatmapItem {\n    x: string; // eg. Bill Gates\n    y: string; // eg. Microsoft\n    count: number; // 15\n    value: string; // "Bill Gates/Microsoft"\n    display: string; // "Bill Gates works at Microsoft"\n    selected?: boolean;\n}\n'})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},72828:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/heatmap-45180c8eaa3c46eeacc3b797a3360bd1.png"},5577:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/settings-46d2667065652ef3007336225ce16f33.png"},28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>l});var n=t(96540);const i={},a=n.createContext(i);function r(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);